# 服务端渲染

### 渲染

什么是渲染 ：把 数据 + 模板 拼接到一起 `<div>{{ msg }}</div>`

使用`art-template` 模板渲染数据

1. 传统的服务端渲染，前后端代码完全耦合，不利于开发维护，服务端压力大，用户体验一般，不够友好

2. 客户端渲染，ajax的出现，服务端渲染 => 客户端渲染，首屏喧染慢，不利于SEO

   > 客户端为什么首屏渲染慢，查看网络，请求资源多，耗时
   >
   > 传统 直接返回html

   > 不利于SEO ，SEO网站在搜索引擎中的排名，搜索关键字可以查到我们的网址，搜索引擎获取网页内容，进行收录，客户端渲染的网页的内容为空，需要 js 脚本进行渲染页面，所以拿不到关键字、关键内容，不利于SEO

3. 现代化的服务端渲染 -> 同构渲染

   1. 通过结合服务端渲染 + 客户端渲染实现
   2. 基于React、和Vue 等框架， 客户端渲染 + 服务端渲染
      1. 在服务器端执行一次，用于实现服务器端渲染（首屏指出）
      2.  客户端在执行一次，用于接管页面交互
   3. 核心解决 SEO 和首屏渲染慢的问题
   4. 拥有两者的优点
   5. 客户端请求 -> 服务端 渲染页面以及生成客户端SPA脚本-> 客户端呈现页面，通过 SPA 脚本，激活应用
   6. 使用Vue、React等框架的官方解决问题
   7. 使用第三方解决方案
      1. React 生态的Next.js
      2. Vue 生态的Nuxt.js
   8. 以Vue生态的Nuxt.js 进行体验

### Vue Nuxt.js 现代化的服务端渲染

1. 安装 nuxt 包，nuxt 根据 pages 自动生成路由
2. 同构体现，
3. 问题：
   1. 开发条件有限
      1. 特定的代码需要在特定的生命周期中使用
      2. 一些外部扩展库需要特殊处理才能在服务端渲染应用中运行
      3. 不能在服务端渲染中操作 DOM
      4. 某些代码操作需要区分环境
   2. 设计构建和部署的要求更多
      1. 客户端渲染 构建：构建客户端，部署：可以部署在任意web服务器
      2. 同构渲染 构建：构建两个端，部署：一般部署在node server
   3. 更多的服务端负载
      1. 占用CPU资源
      2. 高流量下，服务端负载
      3. 需要服务端渲染优化

### 服务端渲染使用建议

1. 首屏渲染速度
2. 需求SEO



### Nuxt.js 

1. 一个基于Vue.js 生态的第三方同构 渲染应用
2. 参考官方使用

```
| pages
| ----- index.vue
| ----- about.vue
```

#### Nuxt router

1. 根据 pages 自动生成 vue-router 路由配置
2. 路由、动态路由、嵌套路由
3. nuxt.config.js 自定义配置



### Nuxt 视图 结构

```

```

1. layouts 布局组件

2. asyncData 异步数据

   1. 只有页面组件才有这个方法，组件没有

   2. 服务端渲染期间和客户端路由更新之前会调用

   3. **没有this**

      <  当你想要动态页面内容有利于 SEO 或者是提升首屏渲染速度的时候，就在asyncData 中请求拿数据

3. 异步数据 没有this 上下文对象 asyncData(context)，context 为上下文对象可以获取

## realworld Nuxt 开源项目

[https://github.com/gothinkster/realworld](https://github.com/gothinkster/realworld)